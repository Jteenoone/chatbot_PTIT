<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quản trị PTIT Chatbot</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-b from-red-50 to-white text-gray-900 antialiased">
  <!-- Header -->
  <header class="border-b border-red-100 bg-white/70 backdrop-blur sticky top-0 z-10">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 grid place-items-center rounded-xl bg-red-600 text-white font-bold">PT</div>
        <div>
          <h1 class="text-lg font-semibold text-red-700">Admin · PTIT Chatbot</h1>
          <p class="text-xs text-gray-500">Quản lý tri thức (KB) & FAQ</p>
        </div>
      </div>
      <a href="/" class="text-xs px-3 py-1 border border-red-200 text-red-700 rounded-lg hover:bg-red-50">← Về trang chat</a>
    </div>
  </header>

  <main class="max-w-5xl mx-auto p-4 md:p-6 space-y-6">
    <!-- Auth Banner -->
    <section id="authBox" class="bg-white border border-red-100 rounded-2xl shadow-sm p-4">
      <h2 class="text-base font-semibold mb-2">Xác thực quản trị</h2>
      <p class="text-sm text-gray-500 mb-3">Nhập mật khẩu admin để thao tác.</p>
      <div class="flex gap-2">
        <input id="adminPass" type="password" placeholder="Mật khẩu admin"
               class="w-full rounded-xl border border-red-200 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-red-600" />
        <button id="btnAuth" class="rounded-xl bg-red-600 text-white px-4 py-2 font-medium shadow hover:bg-red-700">Xác nhận</button>
      </div>
      <p id="authState" class="text-sm mt-2 text-gray-500"></p>
    </section>

    <!-- Tools (hidden until authed) -->
    <section id="tools" class="hidden space-y-6">
      <!-- Upload -->
      <div class="bg-white border border-red-100 rounded-2xl shadow-sm p-4">
        <h3 class="font-semibold mb-2">Upload tài liệu mới</h3>
        <form id="uploadForm" class="flex items-center gap-3" enctype="multipart/form-data">
          <input id="fileInput" name="file" type="file" class="text-sm" />
          <input id="pwUpload" name="password" type="password" placeholder="Mật khẩu admin"
                 class="rounded-xl border border-red-200 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-red-600" />
          <button class="rounded-xl bg-red-600 text-white px-4 py-2 font-medium shadow hover:bg-red-700">Tải lên & cập nhật KB</button>
        </form>
        <p id="uploadMsg" class="text-sm mt-2 text-gray-500"></p>
      </div>

      <!-- KB Files -->
      <div class="bg-white border border-red-100 rounded-2xl shadow-sm p-4">
        <h3 class="font-semibold mb-2">Danh sách tài liệu trong <code>old_docs/</code></h3>
        <ul class="list-disc ml-6 space-y-1 text-sm" id="fileList">
          {% for f in knowledge_files %}
            <li>{{ f }}</li>
          {% endfor %}
          {% if not knowledge_files %}
            <li class="text-gray-500">Chưa có tài liệu.</li>
          {% endif %}
        </ul>
      </div>

      <!-- Reset KB -->
      <div class="bg-white border border-red-100 rounded-2xl shadow-sm p-4">
        <h3 class="font-semibold mb-2">Reset toàn bộ KB</h3>
        <p class="text-sm text-gray-500 mb-3">Xoá ChromaDB hiện tại và build lại từ <code>old_docs/</code>.</p>
        <form id="resetForm" class="flex items-center gap-3">
          <input id="pwReset" name="password" type="password" placeholder="Mật khẩu admin"
                 class="rounded-xl border border-red-200 px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-red-600" />
          <button class="rounded-xl bg-white border border-red-200 text-red-700 px-4 py-2 font-medium shadow hover:bg-red-50">Reset KB</button>
        </form>
        <p id="resetMsg" class="text-sm mt-2 text-gray-500"></p>
      </div>
    </section>
  </main>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden px-4 py-2 rounded-xl bg-neutral-900 text-white shadow"></div>

  <script src="/static/admin.js"></script>
</body>
</html>
